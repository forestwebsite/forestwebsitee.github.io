<script>
const center_x=117.3,center_y=172.8,scale_x=0.02072,scale_y=0.0205
CUSTOM_CRS=L.extend({},L.CRS.Simple,{
  projection:L.Projection.LonLat,
  scale:z=>Math.pow(2,z),
  zoom:sc=>Math.log(sc)/0.6931471805599453,
  distance:(p1,p2)=>Math.sqrt(Math.pow(p2.lng-p1.lng,2)+Math.pow(p2.lat-p1.lat,2)),
  transformation:new L.Transformation(scale_x,center_x,-scale_y,center_y),
  infinite:true
})

var Satelite=L.tileLayer('mapStyles/styleSatelite/{z}/{x}/{y}.jpg',{minZoom:0,maxZoom:8,noWrap:true,continuousWorld:false,id:'Satelite'})
var Atlas=L.tileLayer('mapStyles/styleAtlas/{z}/{x}/{y}.jpg',{minZoom:0,maxZoom:5,noWrap:true,continuousWorld:false,id:'Atlas'})
var Grid=L.tileLayer('mapStyles/styleGrid/{z}/{x}/{y}.png',{minZoom:0,maxZoom:5,noWrap:true,continuousWorld:false,id:'Grid'})
var ExampleGroup=L.layerGroup()
var Icons={"Example":ExampleGroup}
var mymap=L.map('map',{
  crs:CUSTOM_CRS,
  minZoom:1,
  maxZoom:5,
  layers:[Atlas],
  center:[0,0],
  zoom:3
})

function customIcon(i){
  return L.icon({
    iconUrl:'blips/1.png',
    iconSize:[20,20],
    iconAnchor:[20,20],
    popupAnchor:[-10,-27]
  })
}

var coords = [
  [-815.24, -1078.54], [-812.44, -1339.83], [-704.07, -1401.18], [-722.13, -932.13],
  [-807.15, -1376.63], [-828.11, -1257.90], [29.14, -1353.49], [-1179.88, -885.32],
  [-1432.59, -277.20], [-1541.35, 121.86], [-1519.63, 144.05], [378.24, 321.60],
  [932.02, 46.34], [1162.86, -328.20], [-804.52, -1304.18], [-56.02, -1756.88],
  [127.90, -1300.90], [122.33, -1294.05], [85.18, -1393.79], [-224.82, -1396.55],
  [126.02, -207.80], [153.54, -1037.24], [-3169.19, 1060.41], [-3162.46, 1083.49],
  [-1483.01, 106.62], [-628.80, -218.98], [876.12, -2126.41], [1399.57, 1144.57],
  [-335.14, 6153.58], [-388.11, 6235.39], [1685.44, 4822.16], [1932.97, 3722.04],
  [-355.45, -46.79], [-1455.39, -229.52]
]

ExampleGroup.addTo(mymap)

// URL parametresiyle gelen konum (isteğe bağlı)
var params = new URLSearchParams(window.location.search)
var x = parseFloat(params.get('x')) || 0
var y = parseFloat(params.get('y')) || 0
if (x !== 0 || y !== 0) {
  L.marker([y, x], { icon: customIcon(1) }).addTo(ExampleGroup).bindPopup("Burdayım aw")
  mymap.setView([y, x], 4)
} else {
  mymap.setView([0, 0], 3)
}

// Tüm sabit blipleri ekle
coords.forEach(([y, x]) => {
  L.marker([y, x], { icon: customIcon(1) }).addTo(ExampleGroup)
})
</script>
